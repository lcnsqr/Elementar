$(function(){$("a.menu_add").live("click",function(d){d.preventDefault();var b=$(this).parents(".menu_field").first().children(".menu_parent:visible");if($(b).length>0){var a=$(".menu_item_template").first().clone();$(a).removeClass("menu_item_template");$(a).css("display","none");$(b).prepend(a);$(a).show("fast","easeInSine")}else{var c=$(".menu_parent_template").first().clone();var a=$(c).find(".menu_item_template");$(c).removeClass("menu_parent_template");$(c).css("display","none");$(a).removeClass("menu_item_template");$(this).parent(".menu_parent_add").after(c);$(c).show("fast","easeInSine")}});$("a.menu_add_up").live("click",function(b){b.preventDefault();var a=$(".menu_item_template").first().clone();$(a).removeClass("menu_item_template");$(a).css("display","none");$(this).parents("div.menu_item").first().before(a);$(a).show("fast","easeInSine")});$("a.menu_add_down").live("click",function(b){b.preventDefault();var a=$(".menu_item_template").first().clone();$(a).removeClass("menu_item_template");$(a).css("display","none");$(this).parents("div.menu_item").first().after(a);$(a).show("fast","easeInSine")});$("a.menu_add_submenu").live("click",function(d){d.preventDefault();var c=$(".menu_parent_template").first().clone();var a=$(c).find(".menu_item_template");$(c).removeClass("menu_parent_template");$(a).removeClass("menu_item_template");var b=$(this).parents("div.menu_item").first();if($(b).find(".menu_parent").length>0){$(a).css("display","none");$(b).find(".menu_parent").first().prepend(a);$(a).show("fast","easeInSine")}else{$(c).css("display","none");$(this).parents("div.menu_item").first().append(c);$(c).show("fast","easeInSine")}});$("a.menu_delete").live("click",function(c){c.preventDefault();var a=$(this).parents("div.menu_item").first();var b=$(this).parents("div.menu_parent").first();if($(b).find("div.menu_item").length==1&&$(this).parents(".menu_field").first().find("div.menu_item:visible").length>1){$(b).hide("slow",function(){$(this).remove()})}else{if($(this).parents(".menu_field").first().find("div.menu_item:visible").length>1){$(a).hide("slow",function(){$(this).remove()})}}});$(".menu_item_target > input[type='text']").live("click",function(a){var c=$(this).next(".dropdown_items_listing_position").first();var b=$(c).find(".dropdown_items_listing");$(b).fadeIn("fast")});$(".menu_item_target > input[type='text']").live("blur",function(a){var c=$(this).next(".dropdown_items_listing_position").first();var b=$(c).find(".dropdown_items_listing");$(b).fadeOut("fast")});$(".dropdown_items_listing_targets > li > a").live("click",function(b){b.preventDefault();var a=$(this).parents(".dropdown_items_listing_position").first().prev("input");$(a).val($(this).attr("href"))});$("a.menu_up").live("click",function(c){c.preventDefault();var b=$(this).parents("div.menu_item").first();var d=$(b).prev("div.menu_item");if(d.length==1){var a=$(b).detach();$(d).before(a)}});$("a.menu_down").live("click",function(c){c.preventDefault();var b=$(this).parents("div.menu_item").first();var d=$(b).next("div.menu_item");if(d.length==1){var a=$(b).detach();$(d).after(a)}})});$.fn.extend({prepareMenuField:function(){var a=new Array();$(this).children(".menu_parent:not(.menu_parent_template)").each(function(){$(this).children(".menu_item:not(.menu_item_template)").each(function(){var b=$(this).find('input[name="name"]').val();var d=$(this).find('input[name="target"]').val();if($(this).children(".menu_parent:not(.menu_parent_template)").length>0){var c=$(this).prepareMenuField()}else{var c=null}a.push({name:b,target:d,menu:c})})});$(this).find("input.menu_actual_field").val($.toJSON(a))}});