$(function(){$.extend({prepareCompositeFields:function(){$("input.file").each(function(){var a=$.parseJSON($(this).val());if(a!=null){a.title=$("input#"+$(this).attr("id")+"_description").val()}$(this).val($.toJSON(a))});$(".file_gallery_field").each(function(){$(this).prepareFileGalleryField()});$(".menu_field").each(function(){$(this).prepareMenuField()});$(".youtube_gallery_field").each(function(){$(this).prepareYoutubeGalleryField()})}});$.fn.extend({wysiwyg:function(){if($(this).hasClass("p")){var a={script_url:"/js/backend/tiny_mce/tiny_mce.js",theme:"advanced",plugins:"",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,cut,copy,paste,pastetext,|,undo,redo,|,link,unlink,|,code",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:true,width:"100%",force_br_newlines:true,force_p_newlines:false,forced_root_block:"",theme_advanced_source_editor_width:800,theme_advanced_source_editor_height:480,relative_urls:false};$(this).tinymce(a)}else{if($(this).hasClass("hypertext")){var a={script_url:"/js/backend/tiny_mce/tiny_mce.js",theme:"advanced",plugins:"filemanager",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,cut,copy,paste,pastetext,pasteword,|,bullist,numlist,undo,redo,|,link,unlink,filemanager,|,code",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:true,width:"100%",theme_advanced_source_editor_width:800,theme_advanced_source_editor_height:480,relative_urls:false};$(this).tinymce(a)}}}});$("a.file_add").live("click",function(d){d.preventDefault();var e=$(this).parents(".file_gallery_field").first().find(".file_gallery_actual_field");var b=$(this).parents(".file_gallery_field").first().children(".file_parent:not(.file_parent_template)");var a=$(".file_item_template").first().clone();$(a).removeClass("file_item_template");$(a).css("display","none");var c=String((new Date()).getTime()).replace(/\D/gi,"");while($('input[name="file_item_field_'+c+'"]').length>0){var c=String((new Date()).getTime()).replace(/\D/gi,"")}$(a).find(".file_item_field").attr("name","file_item_field_"+c);$(a).find(".file_item_field").attr("id","file_item_field_"+c);$(a).find(".file_item_description_field").attr("name","file_item_field_"+c+"_description");$(a).find(".file_item_description_field").attr("id","file_item_field_"+c+"_description");$(a).find(".file_item_thumbnail").attr("id","file_item_thumbnail_file_item_field_"+c);$(a).find(".file_details").attr("id","file_details_file_item_field_"+c);$(a).find("a.file_erase").attr("href","file_item_field_"+c);$(a).find("a.browse_file").attr("href","file_item_field_"+c);$(b).prepend(a);$(a).show("fast","easeInSine")});$("a.file_add_up").live("click",function(c){c.preventDefault();var d=$(this).parents("div.file_item").first();var a=$(".file_item_template").first().clone();$(a).removeClass("file_item_template");$(a).css("display","none");var b=String((new Date()).getTime()).replace(/\D/gi,"");while($('input[name="file_item_field_'+b+'"]').length>0){var b=String((new Date()).getTime()).replace(/\D/gi,"")}$(a).find(".file_item_field").attr("name","file_item_field_"+b);$(a).find(".file_item_field").attr("id","file_item_field_"+b);$(a).find(".file_item_description_field").attr("name","file_item_field_"+b+"_description");$(a).find(".file_item_description_field").attr("id","file_item_field_"+b+"_description");$(a).find(".file_item_thumbnail").attr("id","file_item_thumbnail_file_item_field_"+b);$(a).find(".file_details").attr("id","file_details_file_item_field_"+b);$(a).find("a.file_erase").attr("href","file_item_field_"+b);$(a).find("a.browse_file").attr("href","file_item_field_"+b);$(d).before(a);$(a).show("fast","easeInSine")});$("a.file_add_down").live("click",function(c){c.preventDefault();var d=$(this).parents("div.file_item").first();var a=$(".file_item_template").first().clone();$(a).removeClass("file_item_template");$(a).css("display","none");var b=String((new Date()).getTime()).replace(/\D/gi,"");while($('input[name="file_item_field_'+b+'"]').length>0){var b=String((new Date()).getTime()).replace(/\D/gi,"")}$(a).find(".file_item_field").attr("name","file_item_field_"+b);$(a).find(".file_item_field").attr("id","file_item_field_"+b);$(a).find(".file_item_description_field").attr("name","file_item_field_"+b+"_description");$(a).find(".file_item_description_field").attr("id","file_item_field_"+b+"_description");$(a).find(".file_item_thumbnail").attr("id","file_item_thumbnail_file_item_field_"+b);$(a).find(".file_details").attr("id","file_details_file_item_field_"+b);$(a).find("a.file_erase").attr("href","file_item_field_"+b);$(a).find("a.browse_file").attr("href","file_item_field_"+b);$(d).after(a);$(a).show("fast","easeInSine")});$("a.file_delete").live("click",function(b){b.preventDefault();var a=$(this).parents("div.file_item").first();$(a).hide("slow",function(){$(this).remove()})});$("a.file_up").live("click",function(c){c.preventDefault();var b=$(this).parents("div.file_item").first();var d=$(b).prev("div.file_item");if(d.length==1){var a=$(b).detach();$(d).before(a)}});$("a.file_down").live("click",function(c){c.preventDefault();var b=$(this).parents("div.file_item").first();var d=$(b).next("div.file_item");if(d.length==1){var a=$(b).detach();$(d).after(a)}});$.fn.extend({prepareFileGalleryField:function(){var a=new Array();$(this).find(".file_item").each(function(){var c=$(this).find("input.file_item_description_field").val();var b=$(this).find("input.file_item_field").val();var d=$.parseJSON(b);if(d!=null){d.title=c;a.push($.toJSON(d))}});$(this).find("input.file_gallery_actual_field").val($.toJSON(a))}});$("input.index_field[type='text']").live("click",function(a){var c=$(this).next(".dropdown_items_listing_position").first();var b=$(c).find(".dropdown_items_listing");$(b).fadeIn("fast")});$("input.index_field[type='text']").live("blur",function(a){var c=$(this).next(".dropdown_items_listing_position").first();var b=$(c).find(".dropdown_items_listing");$(b).fadeOut("fast")});$(".dropdown_items_listing_contents > li > a").live("click",function(b){b.preventDefault();var a=$(this).parents(".dropdown_items_listing_position").first().prev("input");$(a).val($(this).attr("href"))});$.fn.extend({prepareIndexField:function(){}});$("a.menu_add").live("click",function(d){d.preventDefault();var b=$(this).parents(".menu_field").first().children(".menu_parent:visible");if($(b).length>0){var a=$(".menu_item_template").first().clone();$(a).removeClass("menu_item_template");$(a).css("display","none");$(b).prepend(a);$(a).show("fast","easeInSine")}else{var c=$(".menu_parent_template").first().clone();var a=$(c).find(".menu_item_template");$(c).removeClass("menu_parent_template");$(c).css("display","none");$(a).removeClass("menu_item_template");$(this).parent(".menu_parent_add").after(c);$(c).show("fast","easeInSine")}});$("a.menu_add_up").live("click",function(b){b.preventDefault();var a=$(".menu_item_template").first().clone();$(a).removeClass("menu_item_template");$(a).css("display","none");$(this).parents("div.menu_item").first().before(a);$(a).show("fast","easeInSine")});$("a.menu_add_down").live("click",function(b){b.preventDefault();var a=$(".menu_item_template").first().clone();$(a).removeClass("menu_item_template");$(a).css("display","none");$(this).parents("div.menu_item").first().after(a);$(a).show("fast","easeInSine")});$("a.menu_add_submenu").live("click",function(d){d.preventDefault();var c=$(".menu_parent_template").first().clone();var a=$(c).find(".menu_item_template");$(c).removeClass("menu_parent_template");$(a).removeClass("menu_item_template");var b=$(this).parents("div.menu_item").first();if($(b).find(".menu_parent").length>0){$(a).css("display","none");$(b).find(".menu_parent").first().prepend(a);$(a).show("fast","easeInSine")}else{$(c).css("display","none");$(this).parents("div.menu_item").first().append(c);$(c).show("fast","easeInSine")}});$("a.menu_delete").live("click",function(c){c.preventDefault();var a=$(this).parents("div.menu_item").first();var b=$(this).parents("div.menu_parent").first();if($(b).find("div.menu_item").length==1&&$(this).parents(".menu_field").first().find("div.menu_item:visible").length>1){$(b).hide("slow",function(){$(this).remove()})}else{if($(this).parents(".menu_field").first().find("div.menu_item:visible").length>1){$(a).hide("slow",function(){$(this).remove()})}}});$(".menu_item_target > input[type='text']").live("click",function(a){var c=$(this).next(".dropdown_items_listing_position").first();var b=$(c).find(".dropdown_items_listing");$(b).fadeIn("fast")});$(".menu_item_target > input[type='text']").live("blur",function(a){var c=$(this).next(".dropdown_items_listing_position").first();var b=$(c).find(".dropdown_items_listing");$(b).fadeOut("fast")});$(".dropdown_items_listing_targets > li > a").live("click",function(b){b.preventDefault();var a=$(this).parents(".dropdown_items_listing_position").first().prev("input");$(a).val($(this).attr("href"))});$("a.menu_up").live("click",function(c){c.preventDefault();var b=$(this).parents("div.menu_item").first();var d=$(b).prev("div.menu_item");if(d.length==1){var a=$(b).detach();$(d).before(a)}});$("a.menu_down").live("click",function(c){c.preventDefault();var b=$(this).parents("div.menu_item").first();var d=$(b).next("div.menu_item");if(d.length==1){var a=$(b).detach();$(d).after(a)}});$.fn.extend({prepareMenuField:function(){var a=new Array();$(this).children(".menu_parent:not(.menu_parent_template)").each(function(){$(this).children(".menu_item:not(.menu_item_template)").each(function(){var b=$(this).find('input[name="name"]').val();var d=$(this).find('input[name="target"]').val();if($(this).children(".menu_parent:not(.menu_parent_template)").length>0){var c=$(this).prepareMenuField()}else{var c=null}a.push({name:b,target:d,menu:c})})});$(this).find("input.menu_actual_field").val($.toJSON(a))}});$("a.youtube_add").live("click",function(b){b.preventDefault();var a=$(this).parents(".youtube_gallery_field").first().children(".youtube_parent:visible");var c=$(".youtube_item_template").first().clone();$(c).removeClass("youtube_item_template");$(c).css("display","none");$(a).prepend(c);$(c).show("fast","easeInSine")});$("a.youtube_add_up").live("click",function(a){a.preventDefault();var b=$(".youtube_item_template").first().clone();$(b).removeClass("youtube_item_template");$(b).css("display","none");$(this).parents("div.youtube_item").first().before(b);$(b).show("fast","easeInSine")});$("a.youtube_add_down").live("click",function(a){a.preventDefault();var b=$(".youtube_item_template").first().clone();$(b).removeClass("youtube_item_template");$(b).css("display","none");$(this).parents("div.youtube_item").first().after(b);$(b).show("fast","easeInSine")});$("a.youtube_delete").live("click",function(b){b.preventDefault();var c=$(this).parents("div.youtube_item").first();var a=$(this).parents("div.youtube_parent").first();if($(a).find("div.youtube_item").length==1&&$(this).parents(".youtube_gallery_field").first().find("div.youtube_item:visible").length>1){$(a).hide("slow",function(){$(this).remove()})}else{if($(this).parents(".youtube_gallery_field").first().find("div.youtube_item:visible").length>1){$(c).hide("slow",function(){$(this).remove()})}}});$("a.youtube_up").live("click",function(c){c.preventDefault();var b=$(this).parents("div.youtube_item").first();var d=$(b).prev("div.youtube_item");if(d.length==1){var a=$(b).detach();$(d).before(a)}});$("a.youtube_down").live("click",function(c){c.preventDefault();var b=$(this).parents("div.youtube_item").first();var d=$(b).next("div.youtube_item");if(d.length==1){var a=$(b).detach();$(d).after(a)}});$.fn.extend({prepareYoutubeGalleryField:function(){var a=new Array();$(this).children(".youtube_parent:not(.youtube_parent_template)").each(function(){$(this).children(".youtube_item:not(.youtube_item_template)").each(function(){var b=$(this).find('input[name="url"]').val();var c=$(this).find('input[name="description"]').val();if(b!=""){a.push({url:b,description:c})}})});$(this).find("input.youtube_gallery_actual_field").val($.toJSON(a))}})});