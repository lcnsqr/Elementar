$(function(){$("a.file_add").live("click",function(d){d.preventDefault();var e=$(this).parents(".file_gallery_field").first().find(".file_gallery_actual_field");var b=$(this).parents(".file_gallery_field").first().children(".file_parent:not(.file_parent_template)");var a=$(".file_item_template").first().clone();$(a).removeClass("file_item_template");$(a).css("display","none");var c=String((new Date()).getTime()).replace(/\D/gi,"");while($('input[name="file_item_field_'+c+'"]').length>0){var c=String((new Date()).getTime()).replace(/\D/gi,"")}$(a).find(".file_item_field").attr("name","file_item_field_"+c);$(a).find(".file_item_field").attr("id","file_item_field_"+c);$(a).find(".file_item_description_field").attr("name","file_item_field_"+c+"_description");$(a).find(".file_item_description_field").attr("id","file_item_field_"+c+"_description");$(a).find(".file_item_thumbnail").attr("id","file_item_thumbnail_file_item_field_"+c);$(a).find(".file_details").attr("id","file_details_file_item_field_"+c);$(a).find("a.file_erase").attr("href","file_item_field_"+c);$(a).find("a.browse_file").attr("href","file_item_field_"+c);$(b).prepend(a);$(a).show("fast","easeInSine")});$("a.file_add_up").live("click",function(c){c.preventDefault();var d=$(this).parents("div.file_item").first();var a=$(".file_item_template").first().clone();$(a).removeClass("file_item_template");$(a).css("display","none");var b=String((new Date()).getTime()).replace(/\D/gi,"");while($('input[name="file_item_field_'+b+'"]').length>0){var b=String((new Date()).getTime()).replace(/\D/gi,"")}$(a).find(".file_item_field").attr("name","file_item_field_"+b);$(a).find(".file_item_field").attr("id","file_item_field_"+b);$(a).find(".file_item_description_field").attr("name","file_item_field_"+b+"_description");$(a).find(".file_item_description_field").attr("id","file_item_field_"+b+"_description");$(a).find(".file_item_thumbnail").attr("id","file_item_thumbnail_file_item_field_"+b);$(a).find(".file_details").attr("id","file_details_file_item_field_"+b);$(a).find("a.file_erase").attr("href","file_item_field_"+b);$(a).find("a.browse_file").attr("href","file_item_field_"+b);$(d).before(a);$(a).show("fast","easeInSine")});$("a.file_add_down").live("click",function(c){c.preventDefault();var d=$(this).parents("div.file_item").first();var a=$(".file_item_template").first().clone();$(a).removeClass("file_item_template");$(a).css("display","none");var b=String((new Date()).getTime()).replace(/\D/gi,"");while($('input[name="file_item_field_'+b+'"]').length>0){var b=String((new Date()).getTime()).replace(/\D/gi,"")}$(a).find(".file_item_field").attr("name","file_item_field_"+b);$(a).find(".file_item_field").attr("id","file_item_field_"+b);$(a).find(".file_item_description_field").attr("name","file_item_field_"+b+"_description");$(a).find(".file_item_description_field").attr("id","file_item_field_"+b+"_description");$(a).find(".file_item_thumbnail").attr("id","file_item_thumbnail_file_item_field_"+b);$(a).find(".file_details").attr("id","file_details_file_item_field_"+b);$(a).find("a.file_erase").attr("href","file_item_field_"+b);$(a).find("a.browse_file").attr("href","file_item_field_"+b);$(d).after(a);$(a).show("fast","easeInSine")});$("a.file_delete").live("click",function(b){b.preventDefault();var a=$(this).parents("div.file_item").first();$(a).hide("slow",function(){$(this).remove()})});$("a.file_up").live("click",function(c){c.preventDefault();var b=$(this).parents("div.file_item").first();var d=$(b).prev("div.file_item");if(d.length==1){var a=$(b).detach();$(d).before(a)}});$("a.file_down").live("click",function(c){c.preventDefault();var b=$(this).parents("div.file_item").first();var d=$(b).next("div.file_item");if(d.length==1){var a=$(b).detach();$(d).after(a)}})});$.fn.extend({prepareFileGalleryField:function(){var a=new Array();$(this).find(".file_item").each(function(){var c=$(this).find("input.file_item_description_field").val();var b=$(this).find("input.file_item_field").val();var d=$.parseJSON(b);if(d!=null){d.title=c;a.push($.toJSON(d))}});$(this).find("input.file_gallery_actual_field").val($.toJSON(a))}});